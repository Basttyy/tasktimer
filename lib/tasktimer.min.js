!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("tasktimer",[],e):"object"==typeof exports?exports.tasktimer=e():t.tasktimer=e()}(this,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="lib/",n(n.s=0)}([function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(1)),r(n(2))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.freeze({enabled:!0,tickDelay:0,tickInterval:1,totalRuns:null,removeOnCompleted:!1,callback:function(){}}),o=function(){function t(t){this._init(t)}return Object.defineProperty(t.prototype,"name",{get:function(){return this._.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enabled",{get:function(){return this._.enabled},set:function(t){this._.enabled=Boolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tickDelay",{get:function(){return this._.tickDelay},set:function(t){this._.tickDelay=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tickInterval",{get:function(){return this._.tickInterval},set:function(t){this._.tickInterval=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"totalRuns",{get:function(){return this._.totalRuns},set:function(t){this._.totalRuns=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentRuns",{get:function(){return this._.currentRuns},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"callback",{get:function(){return this._.callback},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"removeOnCompleted",{get:function(){return this._.removeOnCompleted},set:function(t){this._.removeOnCompleted=Boolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"completed",{get:function(){return!(!this.totalRuns||this.currentRuns<this.totalRuns)},enumerable:!0,configurable:!0}),t.prototype.reset=function(t){if(this._.currentRuns=0,t){if(t.name)throw new Error("Cannot rename a task.");this._init(t)}return this},t.prototype.toJSON=function(){var t=Object.assign({},this._);return delete t.callback,t},t.prototype._run=function(t){this.enabled&&!this.completed&&(this._.currentRuns+=1,this.callback.apply(null,[this]),t())},t.prototype._init=function(t){if(!t||!t.name)throw new Error("A unique task name is required. Use TaskTimer#add() to create a task with auto-generated name.");if("function"!=typeof t.callback)throw new Error("A callback function is required for a task to be run.");this._=Object.assign({currentRuns:0},r,t)},t}();e.Task=o},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),s=n(0),u=Object.freeze({interval:1e3,stopOnCompleted:!1}),a=function(t){function e(e){var n=t.call(this)||this;return e="number"!=typeof e?Object.assign({},u,e||{}):Object.assign({},u,{interval:e}),n._timer=null,n._reset(),n._.options=e,n}return o(e,t),Object.defineProperty(e.prototype,"interval",{get:function(){return this._.options.interval},set:function(t){this._.options.interval=t||u.interval},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stopOnCompleted",{get:function(){return this._.options.stopOnCompleted},set:function(t){this._.options.stopOnCompleted=Boolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._.state},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"time",{get:function(){var t=this.state!==e.State.STOPPED?Date.now():this._.stopTime;return Object.freeze({started:this._.startTime,stopped:this._.stopTime,elapsed:t-this._.startTime})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tickCount",{get:function(){return this._.tickCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"taskCount",{get:function(){return Object.keys(this._.tasks).length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"runCount",{get:function(){return this._.runCount},enumerable:!0,configurable:!0}),e.prototype.get=function(t){return this._.tasks[t]||null},e.prototype.add=function(t){var e,n=this;return(((e=t)?Array.isArray(e)?e:[e]:[])||[]).forEach(function(t){return n._add(t)}),this},e.prototype.remove=function(t){var n="string"==typeof t?t:t.name;if(t=this.get(n),!n||!t)throw new Error("No tasks exist with name '"+n+"'.");return t.completed&&this._.completedCount>0&&this._.completedCount--,this._.tasks[n]=null,delete this._.tasks[n],this._emit(e.EventType.TASK_REMOVED,t),this},e.prototype.start=function(){return this._stop(),this._.startTime=Date.now(),this._.stopTime=0,this._.tickCount=0,this._.runCount=0,this._run(),this._.state=e.State.RUNNING,this._emit(e.EventType.STARTED),this},e.prototype.pause=function(){return this.state!==e.State.RUNNING?this:(this._stop(),this._.state=e.State.PAUSED,this._emit(e.EventType.PAUSED),this)},e.prototype.resume=function(){return this.state!==e.State.PAUSED?this:(this._run(),this._.state=e.State.RUNNING,this._emit(e.EventType.RESUMED),this)},e.prototype.stop=function(){return this.state!==e.State.RUNNING?this:(this._stop(),this._.stopTime=Date.now(),this._.state=e.State.STOPPED,this._emit(e.EventType.STOPPED),this)},e.prototype.reset=function(){return this._reset(),this._emit(e.EventType.RESET),this},e.prototype._emit=function(t,e){var n={type:t,source:this,data:e};return this.emit(t,n)},e.prototype._add=function(t){var n;if("function"==typeof t&&(t={callback:t}),"object"!==(n=t,Object.prototype.toString.call(n).match(/\s(\w+)/i)[1].toLowerCase())||t.name||(t.name=this._getNewTaskName()),this.get(t.name))throw new Error("A task with name '"+t.name+"' already exists.");var r=t instanceof s.Task?t:new s.Task(t);return this._.tasks[r.name]=r,this._emit(e.EventType.TASK_ADDED,r),this},e.prototype._stop=function(){this._timer&&(clearInterval(this._timer),this._timer=null)},e.prototype._reset=function(){this._stop(),this._={options:(this._||{}).options,state:e.State.IDLE,tasks:{},tickCount:0,runCount:0,startTime:0,stopTime:0,completedCount:0}},e.prototype._tick=function(){var t,n,r=this,o=this._.tasks;for(t in this._.tickCount+=1,o)(n=o[t])&&this.tickCount%n.tickInterval==0&&n._run(function(){r._.runCount+=1,r._emit(e.EventType.TASK,n),n.completed&&(r._.completedCount++,r._emit(e.EventType.TASK_COMPLETED,n),n.removeOnCompleted&&r.remove(n)),r._.completedCount===r.taskCount&&(r._emit(e.EventType.COMPLETED),r.stopOnCompleted&&r.stop())});this._emit(e.EventType.TICK)},e.prototype._run=function(){var t=this;this._timer=setInterval(function(){t._tick(),t._.state=e.State.RUNNING},this._.options.interval)},e.prototype._getNewTaskName=function(){for(var t,e=this.taskCount;!t||this.get(t);)t="task-"+ ++e;return t},e}(i.EventEmitter);e.TaskTimer=a,function(t){t.Task=s.Task,function(t){t.IDLE="idle",t.RUNNING="running",t.PAUSED="paused",t.STOPPED="stopped"}(t.State||(t.State={})),function(t){t.TICK="tick",t.STARTED="started",t.RESUMED="resumed",t.PAUSED="paused",t.STOPPED="stopped",t.RESET="reset",t.TASK="task",t.TASK_ADDED="taskAdded",t.TASK_REMOVED="taskRemoved",t.TASK_COMPLETED="taskCompleted",t.COMPLETED="completed"}(t.EventType||(t.EventType={}))}(a||(a={})),e.TaskTimer=a},function(t,e,n){"use strict";var r=Object.prototype.hasOwnProperty,o="~";function i(){}function s(t,e,n,r,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new function(t,e,n){this.fn=t,this.context=e,this.once=n||!1}(n,r||t,i),u=o?o+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],s]:t._events[u].push(s):(t._events[u]=s,t._eventsCount++),t}function u(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(o=!1)),a.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)r.call(t,e)&&n.push(o?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},a.prototype.listeners=function(t){var e=o?o+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,i=n.length,s=new Array(i);r<i;r++)s[r]=n[r].fn;return s},a.prototype.listenerCount=function(t){var e=o?o+t:t,n=this._events[e];return n?n.fn?1:n.length:0},a.prototype.emit=function(t,e,n,r,i,s){var u=o?o+t:t;if(!this._events[u])return!1;var a,c,p=this._events[u],f=arguments.length;if(p.fn){switch(p.once&&this.removeListener(t,p.fn,void 0,!0),f){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,e),!0;case 3:return p.fn.call(p.context,e,n),!0;case 4:return p.fn.call(p.context,e,n,r),!0;case 5:return p.fn.call(p.context,e,n,r,i),!0;case 6:return p.fn.call(p.context,e,n,r,i,s),!0}for(c=1,a=new Array(f-1);c<f;c++)a[c-1]=arguments[c];p.fn.apply(p.context,a)}else{var l,h=p.length;for(c=0;c<h;c++)switch(p[c].once&&this.removeListener(t,p[c].fn,void 0,!0),f){case 1:p[c].fn.call(p[c].context);break;case 2:p[c].fn.call(p[c].context,e);break;case 3:p[c].fn.call(p[c].context,e,n);break;case 4:p[c].fn.call(p[c].context,e,n,r);break;default:if(!a)for(l=1,a=new Array(f-1);l<f;l++)a[l-1]=arguments[l];p[c].fn.apply(p[c].context,a)}}return!0},a.prototype.on=function(t,e,n){return s(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return s(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,n,r){var i=o?o+t:t;if(!this._events[i])return this;if(!e)return u(this,i),this;var s=this._events[i];if(s.fn)s.fn!==e||r&&!s.once||n&&s.context!==n||u(this,i);else{for(var a=0,c=[],p=s.length;a<p;a++)(s[a].fn!==e||r&&!s[a].once||n&&s[a].context!==n)&&c.push(s[a]);c.length?this._events[i]=1===c.length?c[0]:c:u(this,i)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=o?o+t:t,this._events[e]&&u(this,e)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=o,a.EventEmitter=a,t.exports=a}])});
//# sourceMappingURL=tasktimer.min.js.map